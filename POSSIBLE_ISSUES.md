# Возможные проблемы и ограничения

Краткий список ограничений и того, что уже учтено в коде.

## Уже учтено

- **Повреждение store.json** — запись во временный файл, затем переименование; при сбое основной файл не перезаписывается.
- **Обрыв WebSocket** — клиент переподключается (до 10 попыток с паузой 2 с). После «Отключиться» авто-переподключение не выполняется.
- **Очень большое сообщение** — сервер игнорирует сообщения больше ~15 МБ.
- **Новый клиент** — первые секунды после подключения пустое состояние от нового клиента не перезаписывает общую карту.
- **Метки курсоров** — при применении удалённого состояния старые метки курсоров снимаются с карты (нет «следов»).

## Синхронизация

- **Одновременное редактирование** — используется слияние по `uniqueId` и пооперационная рассылка; правки разных пользователей не затирают друг друга. Рекомендуется не править один и тот же объект с двух мест в один момент.
- **Перезапуск сервера** — клиенты теряют соединение; нужно снова нажать «Подключиться» или дождаться авто-переподключения.
- **Большая карта** — при очень большом числе объектов применение состояния или операций может кратко подтормаживать интерфейс.

## Данные

- **Один процесс** — запускайте один экземпляр `npm run api`; `data/store.json` не рассчитан на запись из нескольких процессов.
- **Резервная копия** — автоматического бэкапа нет. Периодически копируйте `data/store.json` или используйте **Экспорт** в приложении.
- **Сессии** — хранятся в store; после перезапуска сервера старые токены действуют до истечения срока.

## Безопасность

- **Пароли** — простой хэш (демо); для эксплуатации рекомендуется bcrypt/argon2.
- **HTTPS** — при доступе по сети желательно прокси (nginx и т.п.) с TLS.
- **Доступ по IP** — при `host: 0.0.0.0` сервер доступен в локальной сети; при необходимости ограничьте фаерволом.

## Браузер

- Нужны поддержка ES5+, WebSocket, fetch. Рекомендуются актуальные Chrome, Firefox, Edge.
- Сообщения вида `runtime.lastError: Receiving end does not exist` обычно от расширений браузера, не от приложения.

При появлении конкретной ошибки опишите шаги и сообщение — можно точечно доработать.
